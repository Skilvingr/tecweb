function playerButtons(){
    document.getElementById("story").innerHTML="" ;
        var com1="ls ./webapp/completeJson/";
    	$.ajax({
	    type: "GET",
	    datatype: "html",
	    url: "http://site192020.tw.cs.unibo.it/getOut?com=" + com1 +"",
	    success: function(returnData1) {
		//alert(returnData);
		//data=returnData;
		//console.log(data);
		console.log("il primo "+returnData1);
		findButtons1(returnData1);
	    }
	})

   

}

function findButtons1(data){
    var array = data.split("\n");
    console.log("array "+array+""+ array.length);
	for(var i=0;i<array.length - 1;i++){
	var com2= "ls ./webapp/completeJson/"+array[i];
	$.ajax({
	    type: "GET",
	    datatype: "html",
	    url: "http://site192020.tw.cs.unibo.it/getOut?com=" + com2 +"",
	    success: function(returnData2) {
		console.log("il secondo "+returnData2);
		findButtons2(returnData2);
	    }
	})
    }
}

function findButtons2(select){
    var ageValue=document.getElementById("ageSelect").value; 
    var arraySelect=select.split("\n");
    console.log("array "+ arraySelect+""+ arraySelect.length+"age : "+ ageValue);
    for(var j=0;j<arraySelect.length - 1;j++){
	var dif= arraySelect[j].split("-");
	var title=dif[0];
	console.log("dif :"+dif+""+"title :"+title);
	if(dif[1]=="easy.json"&& ageValue=="1"){
	    console.log("patata");
	    createButtonsPlayer(title,dif[1]);
	}
	if(dif[1]=="medium.json"&& ageValue=="2")
	    createButtonsPlayer(title,dif[1]);
	
	if(dif[1]=="hard.json"&& ageValue=="3")    
	    createButtonsPlayer(title,dif[1]);
	
    }
    
}

function createButtonsPlayer(title,dif){
    var br=document.createElement("br");
    var button =document.createElement("button");
    var div=document.getElementById("story");
    button.textContent=title;
    button.setAttribute("onClick","playStory(\"" + title + "\",\""+ dif +"\")");
    div.appendChild(br);
    div.appendChild(button);
}

function addPlayer(){

    var div = document.getElementById("players");
    var newPlayer = document.createElement("div");
    var img = document.createElement("img");
    var bodyCard = document.createElement("div");
    var t = document.createElement("p");
    var p = document.createElement("p");
    var input= document.createElement("input");
    var numPlayer=div.childElementCount;

    if(numPlayer==6)
	return alert("Max 4 Player");
    
    newPlayer.classList.add("card");
    newPlayer.classList.add("playerCard");
    newPlayer.style.width="190px";
    newPlayer.setAttribute("id","player"+(numPlayer-1));
	
    img.classList.add("card-img-top");
    img.classList.add("sizeCard");
    img.src="./mainImg/player.jpeg";
    img.alt="Card image";
    img.style.width="100%";

    bodyCard.classList.add("card-body");

    var t1 = document.createTextNode("Player "+(numPlayer-1));
    t.appendChild(t1);
    
    p.classList.add("p");
    var p1 = document.createTextNode("Scegli il Nome");
    p.appendChild(p1);

    input.classList.add("btn-primary");
    input.classList.add("btn");
    input.size="7";
    input.setAttribute("id","playerName"+(numPlayer-1));

    newPlayer.appendChild(img);
    newPlayer.appendChild(bodyCard);
    bodyCard.appendChild(t);
    bodyCard.appendChild(p);
    bodyCard.appendChild(input);

    div.insertBefore(newPlayer,div.children[(numPlayer-1)]);

    $("#deletePlayer").removeClass("hidden");
    console.log("numero"+(numPlayer-1));
    
}

function deletePlayer(){
    var div = document.getElementById("players");
    var numPlayer = div.childElementCount;
   
    if(numPlayer==4)
	$("#deletePlayer").addClass("hidden");
    
    var del = document.getElementById("player"+(numPlayer-2));
    div.removeChild(del);
    console.log("poppo "+ div.childNodes[numPlayer]);
    console.log("numeroDelete"+numPlayer); 
}

function playStory(title,dif){

   var objP = createPlayerObj();
   console.log(objP);

    generateStory(title,dif); 
}

function createPlayerObj(){

    var playerObj={};
    var div = document.getElementById("players");
    var players = div.childElementCount;

    for(var i = 1; i<(players-1);i++){
	playerObj[i]={};
	playerObj[i].name=document.getElementById("playerName"+i).value;
	playerObj[i].score=0;
	
    }

    return playerObj;
}

function generateStory(title,dif){
    console.log(title);
    console.log(dif);
    
    fetch("completeJson/"+title+"/"+title+"-"+dif)
       .then(function(response) {
            //get JSON data from the response
            return response.json();
        })
	.then(function (story) {
	    generateText(story);
	    generateImg(story);
	    generateExtra(story);
	})

}

